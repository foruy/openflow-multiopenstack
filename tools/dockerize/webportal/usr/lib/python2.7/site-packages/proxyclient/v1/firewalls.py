from proxyclient import base

class Firewall(base.Resource):
    """A Firewall"""
    @property
    def id(self):
        return "%s_%s" % (self._info["instance_id"], self._info["id"])

    def delete(self):
        return self.manager.delete(self)

class FirewallManager(base.Manager):
    resource_class = Firewall

    def get(self, instance):
        return self._list("/os-firewalls/%s" % base.getid(instance),
                          "firewalls")

    def create(self, **kwargs):
        body = {"firewall": kwargs}
        return self._create("/os-firewalls", body, "firewall")

    def delete(self, firewall):
        self._delete("/os-firewalls/%s" % base.getid(firewall))

    def firewall_exist(self, instance_id, **kwargs):
        body = {"firewall": kwargs}
        return self._post("/os-firewalls/%s/action" % base.getid(instance_id),
                          body, "firewall", return_raw=True)
