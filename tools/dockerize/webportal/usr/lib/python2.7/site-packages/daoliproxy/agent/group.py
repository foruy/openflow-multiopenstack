from novaclient.v1_1.paas import groups
from novaclient.v1_1.paas import gateways
from novaclient.v1_1.paas import firewalls

from daoliproxy.agent.nova import novaclient

# Security Group
def _group(request):
    client = novaclient(request)
    return groups.SecurityGroupManager(client)

def security_group_update(request, project_id, **kwargs):
    _group(request).update(project_id, **kwargs)


# Firewall
def _firewall(request):
    client = novaclient(request)
    return firewalls.FirewallManager(client)

def firewall_create(request, instance_id=None, hostname=None,
                    gateway_port=None, service_port=None, fake_zone=None):
    return _firewall(request).create(
        project_id=request.project['id'], instance_id=instance_id,
        hostname=hostname, gateway_port=gateway_port, service_port=service_port,
        fake_zone=fake_zone)

def firewall_delete(request, id):
    _firewall(request).delete(id)

def firewall_update(request, instance_id, **firewall):
    return _firewall(request).firewall_update(instance_id, **firewall)

# Gateway
def _gateway(request):
    client = novaclient(request)
    return gateways.GatewayManager(client)

def gateway_get(request, id):
    return _gateway(request).get(id)

def gateway_list(request):
    return _gateway(request).list()

def gateway_update(request, instance_id, old_gateway, new_gateway):
    return _gateway(request).update(instance_id, old_gateway, new_gateway)
