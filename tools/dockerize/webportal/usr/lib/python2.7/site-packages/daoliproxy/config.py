import os

from oslo.config import cfg
from oslo.db import options

import daoliproxy
from daoliproxy import paths
from daoliproxy import version

CONF = cfg.CONF

def parse_args(argv, default_config_files=None):
    sqlite_db = '%s.sqlite' % daoliproxy.__name__
    connection = 'sqlite:///' + paths.state_path_def(sqlite_db)

    if os.environ.has_key('sql_connection'):
        connection = os.environ['sql_connection']
        sqlite_db = None

    options.set_defaults(CONF, connection=connection, sqlite_db=sqlite_db)

    CONF(argv[1:], project='daoliproxy',
         version=version.version_string(),
         default_config_files=default_config_files)
