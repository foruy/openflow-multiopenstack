users=[
#('testwm', '18611230744', 'wenbo.mao@daolicloud.com', 'g52e90t3'),
#('mingtai101', '13918234299', 'mingtai101@gmail.com', 'fjn7ued1'),
('Yuuki', '15300873506', '18021622551@163.com', 'djnbe9fi'),
('rstevens', '13501099505', '2361228@qq.com', 'bih1g95o'),
('shlallen', '15869045568', 'shlallen@zju.edu.cn', '71i8fzm3'),
('frank', '18610041259', '42376123@qq.com', 'wi2ugmdn'),
('oilbeater', '17098072059', 'liumengxinfly@gmail.com', 'l1cjn35y'),
('ben', '15921531026', 'duyujie.dyj@gmail.com', 'c350bz1j'),
('nsunkai', '13581528614', 'nsunkai@aliyun.com', 'x8e9kv03'),
('shichengge', '18611145331', 'shichengge@huawei.com', 'bnfmsiyj'),
('luluyou', '13564638883', 'xuwy@luluyou.com', 'rownfg7z'),
('gyliu', '15332469064', 'gyliu513@gmail.com', 'laexdgzb'),
('andrew2king', '18651668383', 'jinlongb@cnsuning.com', 'nx1eqr82'),
('Los', '13810055053', 'losanan@gmail.com', 'b1jaikg9'),
('496521310', '', '496521310@qq.com', '6w3y59n1'),
('dunkttt', '13466387638', 'alexliu.liu@gmail.com', '9u4ajvsf'),
('wwy', '13062630060', 'wwy126@126.com', 'vxtm6bz7'),
('hankji', '18610317999', 'jihaiming@163.com', '23rc0ey9'),
('gaoyan', '13967185427', 'gaoyan0571@163.com', 'wvdbm3x5'),
('hldchl', '18514253908', 'hldchl@sohu.com', 'cwy61fvp'),
('624225656', '13661481537', '624225656@qq.com', '5buwhyle'),
('tangqin', '13501027283', 'qtang@runtimebj.com', 'v5y9sp62'),
('my9210', '18601357386', 'runtimebj@163.com', 'ae5k7q34'),
('wayaya', '18611518070', 'jtzs2010@aliyun.com', '3pxu5td0'),
('JennyJiang', '18610830383', 'jennys2n@hotmail.com', 'l76cf4k3'),
]

en_emailbody = "Dear User, \n\n" + \
               "Welcome to visit daolicloud again.\n\n" + \
               "Your account information:\n\n" +\
               "Username: %s\nPassword: %s\nURL: " + \
               "http://www.daolicloud.com/\n\n" +\
               "If you have any questions please let me know by sending email to:\n" +\
               "register@daolicloud.com\n\n" +\
               "Thank you very much!\n" +\
               "DaoliCloud\n\n\n"

def send_mail(receivers, timeout=5):
    import smtplib
    from email.utils import formatdate
    from email.mime.text import MIMEText
    sender = 'register.daolicloud.com'
    smtp = smtplib.SMTP(timeout=timeout)
    smtp.connect('smtp.daolicloud.com')
    smtp.login('register', 'qazwsxedcplmoknijb')
    for rec in receivers:
        message = MIMEText(rec['body'], 'text', 'utf-8')
        message.add_header('Subject', rec['subject'])
        message.add_header('From', sender)
        message.add_header('To', rec['email'])
        message.add_header('Date', formatdate(localtime=True))
        smtp.sendmail(sender, rec['email'], message.as_string())
    smtp.quit()

if __name__ == '__main__':
    for user in users:
        body = en_emailbody % (user[0], user[3])
        receivers = [{'email': 'register@daolicloud.com', 'subject': 'Welcome to DaoliCloud',
                      'body': body}]
        receivers.append({'email': user[2], 'subject': 'Welcome to DaoliCloud',
                      'body': body})
        send_mail(receivers)
        print '%s sendemail successful' % user[0]
